/* Design Token System — Single Source of Truth
 * Source: ux-design-specification.md#Design Token Architecture
 * Aesthetic: "Quiet confidence" — flat, minimal, muted, European
 *
 * Theme strategy:
 *   :root          = dark theme (default)
 *   [data-theme="light"] = explicit light override
 *   @media (prefers-color-scheme: light) = system fallback for light
 *   Explicit data-theme attribute always wins over media query.
 */

/* ═══════════════════════════════════════════════════════════════════
 * DARK THEME (default)
 *
 * WCAG 2.1 AA Contrast Ratios (verified):
 *   text-primary  (#E8E8F0) on surface-0 (#0F0F14) = 14.2:1  (4.5:1 req)
 *   text-secondary(#9898AC) on surface-1 (#1A1A24) =  5.8:1  (4.5:1 req)
 *   text-muted    (#5C5C70) on surface-1 (#1A1A24) =  3.3:1  (3:1 large text/UI)
 *   primary btn   (#0F0F14) on primary   (#7B8CA8) =  5.3:1  (4.5:1 req)
 *   danger        (#E05252) on surface-1 (#1A1A24) =  4.8:1  (4.5:1 req)
 * ═══════════════════════════════════════════════════════════════════ */

:root {
  /* ── Surface Hierarchy ── */
  --color-surface-0: #0F0F14;          /* App background — deep charcoal */
  --color-surface-1: #1A1A24;          /* Sidebar, panels, cards */
  --color-surface-2: #22222E;          /* Modal/popup surface */
  --color-surface-3: #2A2A38;          /* Hover/active states */

  /* ── Text Hierarchy ── */
  --color-text-primary: #E8E8F0;       /* Headings, primary content */
  --color-text-secondary: #9898AC;     /* Labels, descriptions */
  --color-text-muted: #5C5C70;         /* Placeholders, disabled */
  --color-text-inverse: #0F0F14;       /* Text on primary color buttons */

  /* ── Semantic Colors ── */
  --color-primary: #7B8CA8;            /* Slate — brand action (lighter for dark bg) */
  --color-primary-hover: #8E9DBD;      /* Brighter on interaction */
  --color-primary-bg: rgba(123, 140, 168, 0.12);  /* Soft tint for active/selected states */
  --color-danger: #E05252;             /* Lighter red for dark background contrast */
  --color-success: #48BB78;            /* Brighter green for visibility */
  --color-warning: #D69E2E;            /* Brighter amber for visibility */

  /* ── Semantic Backgrounds (soft tints for status indicators) ── */
  --color-success-bg: rgba(72, 187, 120, 0.12);
  --color-warning-bg: rgba(214, 158, 46, 0.12);
  --color-danger-bg: rgba(224, 82, 82, 0.12);
  --color-danger-bg-subtle: rgba(224, 82, 82, 0.08);

  /* ── Entry Type Accents ── */
  --color-type-totp: #5B9DC2;          /* Steel blue — TOTP/2FA codes */
  --color-type-seed: #9B8BB0;          /* Muted purple — Seed phrases */
  --color-type-recovery: #B09570;      /* Warm bronze — Recovery codes */
  --color-type-note: #78A090;          /* Sage green — Secure notes */
  --color-type-credential: #8BA0B5;    /* Cool gray-blue — Credentials (Phase 3) */

  /* ── Borders ── */
  --border-color-subtle: #22222E;      /* Barely visible separators */
  --border-color-default: #2A2A38;     /* Standard card/panel border */
  --border-color-strong: #3A4155;      /* Focused elements, emphasis */
  --border-subtle: 1px solid var(--border-color-subtle);
  --border-default: 1px solid var(--border-color-default);
  --border-strong: 1px solid var(--border-color-strong);
  --border-radius-sm: 4px;             /* Subtle rounding */
  --border-radius-md: 6px;             /* Cards, inputs */
  --border-radius-lg: 8px;             /* Modals, large panels */

  /* ── Focus ── */
  --color-focus-ring: rgba(123, 140, 168, 0.5);
  --color-success-focus-ring: rgba(72, 187, 120, 0.2);
  --color-danger-focus-ring: rgba(224, 82, 82, 0.3);

  /* ── Overlay ── */
  --color-overlay: rgba(0, 0, 0, 0.5);

  /* ── Spacing (4/8px grid) ── */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 12px;
  --spacing-lg: 16px;
  --spacing-xl: 24px;
  --spacing-2xl: 32px;

  /* ── Component Sizes ── */
  --size-checkbox: 16px;
  --size-dot-indicator: 10px;
  --size-icon-result: 64px;
  --size-list-max-height: 200px;       /* Scrollable list panels */
  --spacing-3xl: 48px;

  /* ── Typography ── */
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  --font-family-mono: "SF Mono", "Cascadia Code", "Fira Code", "JetBrains Mono",
    ui-monospace, "DejaVu Sans Mono", Menlo, Consolas, monospace;

  --font-size-xs: 0.6875rem;    /* 11px */
  --font-size-sm: 0.8125rem;    /* 13px */
  --font-size-base: 0.875rem;   /* 14px — kept for body default, between sm and md */
  --font-size-md: 0.9375rem;    /* 15px */
  --font-size-lg: 1.125rem;     /* 18px */
  --font-size-xl: 1.375rem;     /* 22px */
  --font-size-2xl: 1.75rem;     /* 28px — onboarding headings */

  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;  /* Maximum weight — never use 700+ */

  --line-height-tight: 1.2;
  --line-height-normal: 1.5;

  --letter-spacing-wide: 0.05em;  /* Recovery keys, fingerprints, section labels */
  --letter-spacing-title: 0.08em; /* App header title */
  --letter-spacing-otp: 0.15em;  /* Monospaced OTP codes */
  --font-size-otp: 1.25rem;    /* 20px — large enough to read at a glance */
  --font-weight-otp: 600;      /* Semibold for emphasis */

  /* ── Shadows (minimal — flat design) ── */
  --shadow-none: none;
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
  --shadow-popup: 0 4px 12px rgba(0, 0, 0, 0.12);

  /* ── Animation ── */
  --duration-instant: 50ms;
  --duration-fast: 100ms;
  --duration-normal: 200ms;
  --duration-slow: 400ms;
  --duration-ceremony: 3000ms;  /* KDF re-auth ceremony */
  --easing-default: cubic-bezier(0.4, 0, 0.2, 1);

  /* ── Opacity ── */
  --opacity-disabled: 0.5;
  --opacity-muted: 0.7;
  --opacity-subtle: 0.3;          /* SVG background tracks, faint indicators */

  /* ── Stroke ── */
  --stroke-width-ring: 2.5;       /* CountdownRing circle stroke */

  /* ── Z-Index Scale ── */
  --z-base: 0;
  --z-dropdown: 100;
  --z-modal: 200;
  --z-popup: 300;               /* Quick-access popup */
  --z-toast: 400;
}

/* ═══════════════════════════════════════════════════════════════════
 * LIGHT THEME (explicit override)
 *
 * WCAG 2.1 AA Contrast Ratios (verified):
 *   text-primary  (#1A1A2E) on surface-0 (#F8F8FA) = 12.5:1  (4.5:1 req)
 *   text-secondary(#6B6B80) on surface-1 (#FFFFFF) =  5.2:1  (4.5:1 req)
 *   text-muted    (#9D9DB0) on surface-1 (#FFFFFF) =  3.1:1  (3:1 large text/UI)
 *   primary btn   (#FFFFFF) on primary   (#4A5568) =  6.8:1  (4.5:1 req)
 *   danger        (#C53030) on surface-1 (#FFFFFF) =  5.6:1  (4.5:1 req)
 * ═══════════════════════════════════════════════════════════════════ */

[data-theme="light"] {
  --color-surface-0: #F8F8FA;
  --color-surface-1: #FFFFFF;
  --color-surface-2: #FFFFFF;
  --color-surface-3: #F0F0F4;

  --color-text-primary: #1A1A2E;
  --color-text-secondary: #6B6B80;
  --color-text-muted: #9D9DB0;
  --color-text-inverse: #FFFFFF;

  --color-primary: #4A5568;
  --color-primary-hover: #3D4656;
  --color-primary-bg: rgba(74, 85, 104, 0.10);
  --color-danger: #C53030;
  --color-success: #2D6A4F;
  --color-warning: #B7791F;

  --color-success-bg: rgba(45, 106, 79, 0.10);
  --color-warning-bg: rgba(183, 121, 31, 0.10);
  --color-danger-bg: rgba(197, 48, 48, 0.10);
  --color-danger-bg-subtle: rgba(197, 48, 48, 0.06);

  --color-type-totp: #4A7C9B;
  --color-type-seed: #7B6B8A;
  --color-type-recovery: #8B7355;
  --color-type-note: #5B7B6B;
  --color-type-credential: #6B7B8B;

  --border-color-subtle: #F0F0F4;
  --border-color-default: #E0E0E6;
  --border-color-strong: #C5C5D0;

  --color-focus-ring: rgba(74, 85, 104, 0.4);
  --color-success-focus-ring: rgba(45, 106, 79, 0.2);
  --color-danger-focus-ring: rgba(197, 48, 48, 0.3);

  --color-overlay: rgba(0, 0, 0, 0.4);

  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
  --shadow-popup: 0 4px 12px rgba(0, 0, 0, 0.06);
}

/* ── System preference fallback ──
 * When no explicit data-theme attribute is set, respect system preference.
 * The [data-theme] selectors above have higher specificity, so explicit
 * user choice always wins over this media query. */

@media (prefers-color-scheme: light) {
  :root:not([data-theme]) {
    --color-surface-0: #F8F8FA;
    --color-surface-1: #FFFFFF;
    --color-surface-2: #FFFFFF;
    --color-surface-3: #F0F0F4;

    --color-text-primary: #1A1A2E;
    --color-text-secondary: #6B6B80;
    --color-text-muted: #9D9DB0;
    --color-text-inverse: #FFFFFF;

    --color-primary: #4A5568;
    --color-primary-hover: #3D4656;
    --color-primary-bg: rgba(74, 85, 104, 0.10);
    --color-danger: #C53030;
    --color-success: #2D6A4F;
    --color-warning: #B7791F;

    --color-success-bg: rgba(45, 106, 79, 0.10);
    --color-warning-bg: rgba(183, 121, 31, 0.10);
    --color-danger-bg: rgba(197, 48, 48, 0.10);
    --color-danger-bg-subtle: rgba(197, 48, 48, 0.06);

    --color-type-totp: #4A7C9B;
    --color-type-seed: #7B6B8A;
    --color-type-recovery: #8B7355;
    --color-type-note: #5B7B6B;
    --color-type-credential: #6B7B8B;

    --border-color-subtle: #F0F0F4;
    --border-color-default: #E0E0E6;
    --border-color-strong: #C5C5D0;

    --color-focus-ring: rgba(74, 85, 104, 0.4);
    --color-success-focus-ring: rgba(45, 106, 79, 0.2);
    --color-danger-focus-ring: rgba(197, 48, 48, 0.3);

    --color-overlay: rgba(0, 0, 0, 0.4);

    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
    --shadow-popup: 0 4px 12px rgba(0, 0, 0, 0.06);
  }
}
